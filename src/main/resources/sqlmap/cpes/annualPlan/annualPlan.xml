<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="annualPlan">

	<select id="selectAnnualPlanList" parameterType="ony.cpes.internal.annualPlan.bean.APYearBaseIndicBean" resultType="ony.cpes.internal.annualPlan.bean.APYearBaseIndicBean">
		/*annualPlan.selectAnnualPlanList*/
		SELECT AYBI.YEAR_BASE_INDIC_SEQ
			 , AYBI.DEPTH
			 , AYBI.INDIC_ITEM_NM
			 , AYBI.YEAR
			 , AYBI.UPPER_YEAR_BASE_INDIC_SEQ
			 , AYBI.TITLE
			 , @num:=@num+1 AS NUMBER
		FROM CPES_AP_YEAR_BASE_INDIC AYBI
		WHERE (@num:=0)=0
		AND AYBI.VIEW_YN = 'Y'

		<if test="year != null and year != ''">
			AND AYBI.YEAR = #{year}
		</if>
		<if test="depth != null and depth != ''">
			AND AYBI.DEPTH = #{depth}
		</if>
		<if test="title != null and title != ''">
			AND AYBI.TITLE = #{title}
		</if>
		<if test="upperYearBaseIndicSeq != null and upperYearBaseIndicSeq != ''">
			AND AYBI.UPPER_YEAR_BASE_INDIC_SEQ = #{upperYearBaseIndicSeq}
		</if>

	</select>

	<select id="checkDuplAnnualPlan" parameterType="ony.cpes.internal.annualPlan.bean.APYearBaseIndicBean" resultType="int">
		/*annualPlan.checkDuplAnnualPlan*/
		SELECT COUNT(1) AS CNT
		FROM CPES_AP_YEAR_BASE_INDIC AYBI
		WHERE AYBI.VIEW_YN = 'Y'
		AND YEAR = #{year}
		AND DEPTH = #{depth}
		AND INDIC_ITEM_NM = #{indicItemNm}
		AND TITLE = #{title}
	</select>

	<select id="selectAPIndicDataList" parameterType="ony.cpes.internal.annualPlan.bean.APYearBaseIndicBean" resultType="ony.cpes.internal.annualPlan.bean.APIndicDataBean">
		/*annualPlan.selectAPIndicDataList*/
		SELECT AID.INDIC_DATA_SEQ
			 , AID.YEAR_BASE_INDIC_SEQ
			 , AID.JC_CD
			 , AID.CONTENT
			 , AID.RESULT
			 , AID.MONTH
		FROM CPES_AP_INDIC_DATA AID
		WHERE AID.VIEW_YN = 'Y'
		AND AID.YEAR_BASE_INDIC_SEQ = #{yearBaseIndicSeq}
		AND AID.JC_CD = #{jcCd}

		ORDER BY AID.MONTH ASC
	</select>

</mapper>
