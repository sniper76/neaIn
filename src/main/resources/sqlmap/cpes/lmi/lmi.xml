<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="lmi">

	<select id="selectLmiDepthList" parameterType="ony.cpes.internal.lmi.bean.LmiYearBaseIndicBean" resultType="ony.cpes.internal.lmi.bean.LmiYearBaseIndicBean">
		/*lmi.selectLmiDepthList*/
		SELECT LYBI.LMI_YEAR_BASE_INDIC_SEQ
			 , LYBI.DEPTH
			 , LYBI.INDIC_ITEM_NM
			 , LYBI.YEAR
			 , LYBI.UPPER_LMI_YEAR_BASE_INDIC_SEQ
			 , LYBI.FULL_LMI_YEAR_BASE_INDIC_SEQ
			 , LID.CONTENT
			 , LID.LMI_INDIC_DATA_SEQ
		FROM CPES_LMI_YEAR_BASE_INDIC LYBI
			LEFT JOIN CPES_LMI_INDIC_DATA LID
			ON LYBI.LMI_YEAR_BASE_INDIC_SEQ = LID.LMI_YEAR_BASE_INDIC_SEQ
		WHERE LYBI.VIEW_YN = 'Y'
		AND LYBI.YEAR = #{year}
		<if test="depth != null and depth != ''">
			AND LYBI.DEPTH = #{depth}
		</if>
		<if test="upperLmiYearBaseIndicSeq != null and upperLmiYearBaseIndicSeq != ''">
			AND LYBI.UPPER_LMI_YEAR_BASE_INDIC_SEQ = #{upperLmiYearBaseIndicSeq}
		</if>
	</select>

	<select id="checkDuplLmi" parameterType="ony.cpes.internal.lmi.bean.LmiYearBaseIndicBean" resultType="int">
		SELECT COUNT(1) AS CNT
		FROM CPES_LMI_YEAR_BASE_INDIC LYBI
		WHERE VIEW_YN = 'Y'
		AND YEAR = #{year}
		AND DEPTH = #{depth}
		AND INDIC_ITEM_NM = #{indicItemNm}
	</select>

</mapper>
