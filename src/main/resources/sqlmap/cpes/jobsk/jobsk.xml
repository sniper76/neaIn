<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jobsk">

	<select id="selectJobskList" resultType="JobskBean" parameterType="JobskBean">
		SELECT
		${totalCount} - ((${pageNo} - 1) * ${length}) - (@ROWNUM := @ROWNUM + 1) + 1 AS ROW_NUM
		, TAB.JOBSK_REQ_SEQ
		, TAB.RESUME_SEQ
		, TAB.USER_SEQ
		, TAB.USER_ID
		, TAB.USER_AUTH_CD
		, TAB.USER_AUTH_NM
		, TAB.USER_NM
		, TAB.RESUME_TITLE
		, TAB.USER_EMAIL
		, TAB.USER_CELL
		, TAB.AGE
		, TAB.GENDER_NM
		, TAB.JC_AGREE_STS_NM
		, TAB.JOBSK_STS_NM	
		, TAB.REG_DT	
		, TAB.JC_AGREE_DT
		, TAB.NOW_WORK_YN
		, TAB.URGENT_JOBSEEK_YN
		, TAB.BIRTH_ADDR_DTL
		, TAB.MARRI_NM
		, TAB.ORDER_BY			 		
		FROM (
				SELECT
				A.JOBSK_REQ_SEQ
				, A.RESUME_SEQ
				, B.USER_SEQ
				, C.USER_ID
				, C.USER_AUTH_CD
				, FN_GET_COMMON_NM('USER_AUTH_CD', C.USER_AUTH_CD, #{lang}) AS USER_AUTH_NM
				, CASE WHEN #{lang} = 'kh' THEN C.USER_NM_KH ELSE C.USER_NM_EN END AS USER_NM
				, B.RESUME_TITLE
				, C.USER_EMAIL
				, C.USER_CELL
				, FLOOR((CAST(REPLACE(CURRENT_DATE,'-', #{lang}) AS UNSIGNED) - 
				CAST(REPLACE(C.BIRTH,'-', #{lang}) AS UNSIGNED)) / 10000 ) AS AGE
				, FN_GET_COMMON_NM('GENDER_CD', C.GENDER_CD, #{lang}) AS GENDER_NM
				, FN_GET_COMMON_NM('JC_AGREE_STS_CD', A.JC_AGREE_STS_CD, #{lang}) AS JC_AGREE_STS_NM
				, FN_GET_COMMON_NM('JOBSK_STS_CD', C.JOBSK_STS_CD, #{lang}) AS JOBSK_STS_NM
				, FN_GET_BASE_DATE_TIME(A.REG_DT, 'I', #{lang}) AS REG_DT 
				, FN_GET_BASE_DATE_TIME(A.JC_AGREE_DT, 'I', #{lang}) AS JC_AGREE_DT
				, B.NOW_WORK_YN
				, B.URGENT_JOBSEEK_YN
				, B.BIRTH_ADDR_DTL
				, FN_GET_COMMON_NM('MARRI_CD', B.MARRI_CD, #{lang}) AS MARRI_NM
				, A.REG_DT AS ORDER_BY
				FROM CPES_JOBSK_REQ A
				INNER JOIN CPES_RESUME B
				ON A.RESUME_SEQ        	= B.RESUME_SEQ
				INNER JOIN CPES_USER C
				ON B.USER_SEQ           = C.USER_SEQ
				<where>
				    AND C.USER_AUTH_CD		IN ('ROLE_USER', 'ROLE_STDIT')
					<if test="jcCd != null and jcCd != ''">
					AND A.JC_CD				LIKE CONCAT('%', #{jcCd}, '%') 
					</if>			
					<if test="lang == 'kh'">
					AND C.USER_NM_KH		LIKE CONCAT('%', #{userNm}, '%') 
					</if>
					<if test="lang == 'en'">
					AND C.USER_NM_EN		LIKE CONCAT('%', #{userNm}, '%') 
					</if>
					<if test="userEmail != null and userEmail != ''">
					AND C.USER_EMAIL		LIKE CONCAT('%', #{userEmail}, '%') 
					</if>
					<if test="userCell != null and userCell != ''">
					AND C.USER_CELL			LIKE CONCAT('%', #{userCell}, '%') 
					</if>					
					<if test="userAuthCd != null and userAuthCd != ''">
					AND C.USER_AUTH_CD		LIKE CONCAT('%', #{userAuthCd}, '%')
					</if>						
					<if test="jobskStsCd != null and jobskStsCd != ''">
					AND C.JOBSK_STS_CD		LIKE CONCAT('%', #{jobskStsCd}, '%')
					</if>	
					<if test="genderCd != null and genderCd != ''">
					AND C.GENDER_CD			LIKE CONCAT('%', #{genderCd}, '%')
					</if>
					<if test="userStsCd != null and userStsCd != ''">
					AND C.USER_STS_CD		LIKE CONCAT('%', #{userStsCd}, '%')
					</if>
					<if test="jcAgreeStsCd != null and jcAgreeStsCd != ''">
					AND A.JC_AGREE_STS_CD	LIKE CONCAT('%', #{jcAgreeStsCd}, '%')
					</if>
					<if test="urgentJobseekYn != null and urgentJobseekYn != ''">
					AND B.URGENT_JOBSEEK_YN	LIKE CONCAT('%', #{urgentJobseekYn}, '%')
					</if>
					<if test="nowWorkYn != null and nowWorkYn != ''">
					AND B.NOW_WORK_YN		LIKE CONCAT('%', #{nowWorkYn}, '%')
					</if>
					<if test="startDate != null and startDate != ''">
					<![CDATA[
					AND A.REG_DT			>= FN_GET_STR_TO_DATE(#{startDate}, 'S')
					]]>
					</if>
					<if test="endDate != null and endDate != ''">
					<![CDATA[			
					AND A.REG_DT			<= FN_GET_STR_TO_DATE(#{endDate}, 'E')
					]]>
					</if>
					AND A.DEL_YN			!= 'Y'																					
				</where>
	    ) TAB
	    ,(SELECT @ROWNUM := 0) Z
		<choose>
			<when test="orderColumn == 'REG_DT'">
				ORDER BY TAB.ORDER_BY ${orderColumnSort}
			</when>
        	<otherwise>
            	ORDER BY ${orderColumn} ${orderColumnSort}
            </otherwise>

        </choose>
		<if test="length > -1">
		LIMIT 
			${start} , ${length}				
		</if>		
    </select>

	<select id="selectJobskListTotalCnt" resultType="java.lang.Integer" parameterType="jobskBean">
       SELECT COUNT(*) AS TOTAL_COUNT
		FROM CPES_JOBSK_REQ A
		INNER JOIN CPES_RESUME B
		ON A.RESUME_SEQ        	= B.RESUME_SEQ
		INNER JOIN CPES_USER C
		ON B.USER_SEQ           = C.USER_SEQ
		<where>
		    AND C.USER_AUTH_CD		IN ('ROLE_USER', 'ROLE_STDIT')
			<if test="jcCd != null and jcCd != ''">
			AND A.JC_CD				LIKE CONCAT('%', #{jcCd}, '%') 
			</if>			
			<if test="lang == 'kh'">
			AND C.USER_NM_KH		LIKE CONCAT('%', #{userNm}, '%') 
			</if>
			<if test="lang == 'en'">
			AND C.USER_NM_EN		LIKE CONCAT('%', #{userNm}, '%') 
			</if>
			<if test="userEmail != null and userEmail != ''">
			AND C.USER_EMAIL		LIKE CONCAT('%', #{userEmail}, '%') 
			</if>
			<if test="userCell != null and userCell != ''">
			AND C.USER_CELL			LIKE CONCAT('%', #{userCell}, '%') 
			</if>					
			<if test="userAuthCd != null and userAuthCd != ''">
			AND C.USER_AUTH_CD		LIKE CONCAT('%', #{userAuthCd}, '%')
			</if>						
			<if test="jobskStsCd != null and jobskStsCd != ''">
			AND C.JOBSK_STS_CD		LIKE CONCAT('%', #{jobskStsCd}, '%')
			</if>	
			<if test="genderCd != null and genderCd != ''">
			AND C.GENDER_CD			LIKE CONCAT('%', #{genderCd}, '%')
			</if>
			<if test="userStsCd != null and userStsCd != ''">
			AND C.USER_STS_CD		LIKE CONCAT('%', #{userStsCd}, '%')
			</if>
			<if test="jcAgreeStsCd != null and jcAgreeStsCd != ''">
			AND A.JC_AGREE_STS_CD	LIKE CONCAT('%', #{jcAgreeStsCd}, '%')
			</if>
			<if test="urgentJobseekYn != null and urgentJobseekYn != ''">
			AND B.URGENT_JOBSEEK_YN	LIKE CONCAT('%', #{urgentJobseekYn}, '%')
			</if>
			<if test="nowWorkYn != null and nowWorkYn != ''">
			AND B.NOW_WORK_YN		LIKE CONCAT('%', #{nowWorkYn}, '%')
			</if>
			<if test="startDate != null and startDate != ''">
			<![CDATA[
			AND A.REG_DT			>= FN_GET_STR_TO_DATE(#{startDate}, 'S')
			]]>
			</if>
			<if test="endDate != null and endDate != ''">
			<![CDATA[			
			AND A.REG_DT			<= FN_GET_STR_TO_DATE(#{endDate}, 'E')
			]]>
			</if>
			AND A.DEL_YN			!= 'Y'																					
		</where>
    </select>
 
	<select id="selectJobskUserSeq" resultType="JobskBean" parameterType="JobskBean">
	    SELECT 
	    C.USER_SEQ
	    FROM CPES_JOBSK_REQ A
	    , CPES_RESUME B
	    , CPES_USER C
	    WHERE A.RESUME_SEQ			= B.RESUME_SEQ
	      AND B.USER_SEQ			= C.USER_SEQ
	      AND A.JOBSK_REQ_SEQ		= #{jobskReqSeq}
    </select>
        
	<select id="selectJobskDtlInfoBase" resultType="JobskBean" parameterType="JobskBean">
		SELECT
		A.JOBSK_REQ_SEQ
		, B.RESUME_SEQ
		, C.USER_SEQ
		, CASE WHEN #{lang} = 'kh' THEN C.USER_NM_KH ELSE C.USER_NM_EN END AS USER_NM
		, C.USER_AUTH_CD
		, FN_GET_COMMON_NM('USER_AUTH_CD', C.USER_AUTH_CD, #{lang}) AS USER_AUTH_NM
		, C.USER_CELL
		, FLOOR((CAST(REPLACE(CURRENT_DATE,'-',#{lang}) AS UNSIGNED) - 
		       		CAST(REPLACE(C.BIRTH,'-',#{lang}) AS UNSIGNED)) / 10000 ) AS AGE
		, C.GENDER_CD
		, FN_GET_COMMON_NM('GENDER_CD', C.GENDER_CD, #{lang}) AS GENDER_NM
		, C.USER_EMAIL
		, C.JOBSK_STS_CD
		, FN_GET_COMMON_NM('JOBSK_STS_CD', C.JOBSK_STS_CD, #{lang}) AS JOBSK_STS_NM
		, C.ADDR_FULL_NM
		, B.NOW_WORK_YN
		, B.URGENT_JOBSEEK_YN
		, B.FILE_GRP_SEQ
		, B.RESUME_TITLE
		, B.BIRTH_ADDR_DTL
		, FN_GET_COMMON_NM('MARRI_CD', B.MARRI_CD, #{lang}) AS MARRI_NM
		, B.FAMILY_CNT
		, B.UNDER_AGE15_FAMILY_CNT
		, B.OVER_AGE64_FAMILY_CNT
		, B.FRSTIME_JOB_SEEKER_YN
		, B.STUDYING_YN
		, B.RET_MIGRAT_YN
		, B.SRVC_YN
		, B.ETHNIC_MINOR_YN
		, B.DISABL_YN
		, B.SELFEMP_YN
		, B.PREFER_JOB_TITLE
		, B.PREFER_POSITION
		, FN_GET_COMMON_NM('EMPLOY_FORM_CD', B.EMPLOY_FORM_CD, #{lang}) AS EMPLOY_FORM_NM
		, FN_GET_COMMON_NM('PREFER_EMPLOYMT_TYPE_CD', B.PREFER_EMPLOY_TYPE_CD, #{lang}) AS PREFER_EMPLOY_TYPE_NM
		, B.TYPE_EMPLOY_HOUR_DAY
		, B.TYPE_EMPLOY_DAY_WEEK
		, B.PREFER_DAY_MON
		, B.PREFER_DAY_TUE
		, B.PREFER_DAY_WED
		, B.PREFER_DAY_THU
		, B.PREFER_DAY_FRI
		, B.PREFER_DAY_SAT
		, B.PREFER_DAY_SUN
		, FN_GET_COMMON_NM('EMPLOY_CRTCT_CD', B.PREFER_CRTCT_TYPE, #{lang}) AS PREFER_CRTCT_TYPE_NM
		, B.NIGHT_WORK_YN
		, B.OVER_TIME_WORK_YN
		, B.HLDAY_WORK_YN
		, B.EXPCT_MIN_SALARY_AMT
		, B.EXPCT_MAX_SALARY_AMT
		, B.DIFF_PROVC_WORK_YN
		, B.WORK_BGN_ABLE_YN
		, B.WORK_BGN_ABLE_WITHIN
		, B.TOT_CAREER_TERM_YEAR_CNT
		, B.TOT_CAREER_TERM_MONTH_CNT
		, FN_GET_COMMON_NM('ISCED_CD', D.ISCED_CD, #{lang}) AS EDU_GNRL_ISCED_NM
		, FN_GET_COMMON_NM('ISCED_CD', E.ISCED_CD, #{lang}) AS EDU_SKILL_ISCED_NM
		, B.PRO_LICNS_YN
		, B.PRO_LICNS_SPEC
		, FN_GET_BASE_DATE_TIME(A.REG_DT, 'I', #{lang}) AS REG_DT
		, FN_GET_BASE_DATE_TIME(A.JC_AGREE_DT, 'I', #{lang}) AS JC_AGREE_DT
		, A.JC_AGREE_STS_CD
		, FN_GET_COMMON_NM('JC_AGREE_STS_CD', A.JC_AGREE_STS_CD, #{lang}) AS JC_AGREE_STS_NM
		, CASE WHEN #{lang} = 'kh' THEN F.USER_NM_KH ELSE F.USER_NM_EN END AS JC_USER_NM
		, A.AGREE_REJECT_REASON		
		FROM CPES_JOBSK_REQ A
		INNER JOIN CPES_RESUME B
		ON A.RESUME_SEQ = B.RESUME_SEQ
		INNER JOIN CPES_USER C
		ON B.USER_SEQ = C.USER_SEQ
		LEFT JOIN CPES_RESUME_GENRL_EDU D
		ON B.RESUME_SEQ	= D.RESUME_SEQ
		LEFT JOIN CPES_RESUME_TVET_EDU E
		ON B.RESUME_SEQ	= E.RESUME_SEQ
		LEFT JOIN CPES_USER F
		ON A.JC_USER_SEQ = F.USER_SEQ
		WHERE A.JOBSK_REQ_SEQ				= #{jobskReqSeq}
    </select>     

	<select id="selectJobskDisableOptNm" resultType="JobskBean" parameterType="JobskBean">
		SELECT 
		CASE WHEN #{lang} = 'kh' THEN CD_KH_NM ELSE CD_EN_NM END DISABL_OPTION_NM
		FROM CPES_COMM_DTL_CD
		WHERE GRP_CD		= 'DISABL_OPTION_CD'
		AND DTL_CD			= #{disablOptionCd}
    </select>
    
	<select id="selectJobskIscoList" resultType="JobskIscoBean" parameterType="JobskIscoBean">
		SELECT 
		A.ISCO_CD
		, CASE WHEN #{lang} = 'kh' THEN B.KH_NM ELSE B.EN_NM END AS ISCO_NM
		FROM CPES_RESUME_ISCO A
		, CPES_ISCO_CD B
		WHERE A.ISCO_CD         = B.ISCO_CD
		AND A.RESUME_SEQ       	= #{resumeSeq}
    </select>     

	<select id="selectJobskPreferWorkLocList" resultType="JobskLocBean" parameterType="JobskLocBean">
		SELECT ADDR_FULL_NM
		FROM CPES_RESUME_HOPE_WORK_LOC
		WHERE RESUME_SEQ       	= #{resumeSeq}
    </select> 
    
	<select id="selectJobskSpcEduList" resultType="JobskSpcEduBean" parameterType="JobskSpcEduBean">
		SELECT 
		A.SPECIAL_STUDY_NM
		, FN_GET_BASE_DATE_CHAR(A.BGN_DT, #{lang}) AS BGN_DT
		, FN_GET_BASE_DATE_CHAR(A.END_DT, #{lang}) AS END_DT
		, A.INSTT_NM
		, A.CNTRY_CD
		, CASE WHEN #{lang} = 'kh' THEN C.NM_KH ELSE C.NM_EN END AS CNTRY_NM
		, A.PROVC_CD
		, CASE WHEN #{lang} = 'kh' THEN D.NM_KH ELSE D.NM_EN END AS PROVC_NM 
		FROM CPES_RESUME_SPECIAL_STUDY A
		JOIN CPES_RESUME B
		ON A.RESUME_SEQ			= B.RESUME_SEQ
		LEFT JOIN CPES_LOC_CD C
		ON A.CNTRY_CD           = C.LOC_SEQ
		LEFT JOIN CPES_LOC_CD D
		ON A.PROVC_CD           = D.LOC_SEQ
		WHERE B.RESUME_SEQ      = #{resumeSeq}
		;
		
    </select>    
    
	<select id="selectJobskOtrTrnngList" resultType="JobskOtrTrnngBean" parameterType="JobskOtrTrnngBean">
		SELECT 
		A.RESUME_OTHER_TRNNG_SEQ
		, A.RESUME_OTHER_TRNNG_ID
		, FN_GET_BASE_DATE_CHAR(A.BGN_DT, #{lang}) AS BGN_DT
		, FN_GET_BASE_DATE_CHAR(A.END_DT, #{lang}) AS END_DT
		, A.TRNNG_EDU_DEGREE_CD
		, FN_GET_COMMON_NM('EDU_DEGREE_CD', A.TRNNG_EDU_DEGREE_CD, #{lang}) AS TRNNG_EDU_DEGREE_NM
		, A.INSTT_NM
		, A.ISCED_CD
		, CASE WHEN #{lang} = 'kh' THEN C.KH_NM ELSE C.EN_NM END AS ISCED_NM
		, A.ADDR_PROVC_CD
		, CASE WHEN #{lang} = 'kh' THEN D.NM_KH ELSE D.NM_EN END AS ADDR_PROVC_NM
		, A.REG_USER_SEQ
		, A.REG_DT
		, A.MOD_USER_SEQ
		, A.MOD_DT
		, A.RESUME_SEQ 
		FROM CPES_RESUME_OTHER_TRNNG A
		JOIN CPES_RESUME B
		ON A.RESUME_SEQ					= B.RESUME_SEQ
		LEFT JOIN CPES_ISCED_CD C
		ON A.ISCED_CD					= C.ISCED_CD
		LEFT JOIN CPES_LOC_CD D
		ON A.ADDR_PROVC_CD				= D.LOC_SEQ
		WHERE B.RESUME_SEQ				= #{resumeSeq};
    </select>
        
	<select id="selectJobskLangList" resultType="JobskLangBean" parameterType="JobskLangBean">
		SELECT 
		A.RESUME_LANG_SEQ
		, A.RESUME_LANG_ID
		, A.LANG_CD
		, FN_GET_COMMON_NM('LANG_CD', A.LANG_CD, #{lang}) AS LANG_NM
		, A.LANG_LVL_CD
		, FN_GET_COMMON_NM('LANG_LVL_CD', A.LANG_LVL_CD, #{lang}) AS LANG_LVL_NM
		, A.LANG_TYPE_CD
		, FN_GET_COMMON_NM('LANG_TYPE_CD', A.LANG_TYPE_CD, #{lang}) AS LANG_TYPE_NM
		, A.RESUME_SEQ
		, A.REG_USER_SEQ
		, A.REG_DT
		, A.MOD_USER_SEQ
		, A.MOD_DT 
		FROM CPES_RESUME_LANG A
		, CPES_RESUME B
		WHERE A.RESUME_SEQ			= B.RESUME_SEQ
		AND B.USER_SEQ				= #{userSeq}
		ORDER BY A.LANG_TYPE_CD ASC;
    </select>

	<select id="selectJobskWorkExpList" resultType="JobskWorkExpBean" parameterType="JobskWorkExpBean">
		SELECT 
		A.RESUME_WORK_EXP_SEQ
		, A.RESUME_WORK_EXP_ID
		, FN_GET_BASE_DATE_CHAR(A.BGN_DT, #{lang}) AS BGN_DT
		, FN_GET_BASE_DATE_CHAR(A.END_DT, #{lang}) AS END_DT
		, A.ISCO_CD
		, CASE WHEN #{lang} = 'kh' THEN C.KH_NM ELSE C.EN_NM END AS ISCO_NM
		, A.ISIC_CD
		, CASE WHEN #{lang} = 'kh' THEN D.KH_NM ELSE D.EN_NM END AS ISIC_NM
		, A.ORGNZ_NM
		, A.LEAVE_REASON
		, A.ADDR_PROVC_CD
		, CASE WHEN #{lang} = 'kh' THEN E.NM_KH ELSE E.NM_EN END AS ADDR_PROVC_NM
		, A.RESUME_SEQ
		, A.SELFEMP_YN
		, A.JOB_SECTOR
		, A.JOB_POSITION
		FROM CPES_RESUME_WORK_EXP A
		JOIN CPES_RESUME B
		ON A.RESUME_SEQ					= B.RESUME_SEQ
		LEFT JOIN CPES_ISCO_CD C
		ON A.ISCO_CD					= C.ISCO_CD
		LEFT JOIN CPES_ISIC_CD D
		ON A.ISIC_CD					= D.ISIC_CD
		LEFT JOIN CPES_LOC_CD E
		ON A.ADDR_PROVC_CD				= E.LOC_SEQ 
		WHERE B.RESUME_SEQ				= #{resumeSeq}
		;
		 
    </select>

	<select id="selectJobskSkillList" resultType="JobskSkillBean" parameterType="JobskSkillBean">
		SELECT 
		A.RESUME_SKILL_SEQ
		, A.RESUME_SKILL_ID
		, A.SKILL_CD
		, FN_GET_COMMON_NM('SKILL_CD', A.SKILL_CD, #{lang}) AS SKILL_NM
		, A.REG_USER_SEQ
		, A.REG_DT
		, A.MOD_USER_SEQ
		, A.MOD_DT
		, A.RESUME_SEQ 
		FROM CPES_RESUME_SKILL A
		, CPES_RESUME B
		WHERE A.RESUME_SEQ			= B.RESUME_SEQ
		AND B.RESUME_SEQ			= #{resumeSeq}
		AND A.SKILL_CD				LIKE CONCAT ('%', '00', '')
		ORDER BY A.SKILL_CD ASC
		;
		 
    </select>

	<select id="selectJobskSkillDtlList" resultType="JobskSkillBean" parameterType="JobskSkillBean">
		SELECT 
		A.RESUME_SKILL_SEQ
		, A.RESUME_SKILL_ID
		, A.SKILL_CD
		, FN_GET_COMMON_NM('SKILL_CD', A.SKILL_CD, #{lang}) AS SKILL_NM
		, A.REG_USER_SEQ
		, A.REG_DT
		, A.MOD_USER_SEQ
		, A.MOD_DT
		, A.RESUME_SEQ 
		FROM CPES_RESUME_SKILL A
		, CPES_RESUME B
		WHERE A.RESUME_SEQ			= B.RESUME_SEQ
		AND B.RESUME_SEQ			= #{resumeSeq}
		AND A.SKILL_CD				LIKE CONCAT ('', #{skillCd}, '%')
		ORDER BY A.SKILL_CD ASC
		;
		 
    </select>
 
	<select id="selectJobskRcmdmanList" resultType="JobskRcmdmanBean" parameterType="JobskRcmdmanBean">
		SELECT 
		A.RESUME_REF_MAN_SEQ
		, A.RESUME_REF_MAN_ID
		, A.NM
		, A.ORGNZ_NM
		, A.POSITION
		, A.REF
		, A.CELL
		, A.EMAIL
		, A.ADDR_FULL_NM
		, A.REG_USER_SEQ
		, A.REG_DT
		, A.MOD_USER_SEQ
		, A.MOD_DT
		, A.RESUME_SEQ 
		FROM CPES_RESUME_REF_MAN A
		, CPES_RESUME B
		WHERE A.RESUME_SEQ			= B.RESUME_SEQ
		AND B.RESUME_SEQ			= #{resumeSeq}
		;
		 
    </select> 
                        
	<select id="selectJobskVacancyList" resultType="JobskVacancyBean" parameterType="JobskVacancyBean">
		SELECT
		${totalCount} - ((${pageNo} - 1) * ${length}) - (@ROWNUM := @ROWNUM + 1) + 1 AS ROW_NUM
		, TAB.VACANCY_SEQ
		, TAB.COMPNY_SEQ
		, TAB.VACANCY_ID
		, TAB.EMPLOY_FORM_CD
		, TAB.EMPLOY_FORM_NM	
		, TAB.COMPNY_NM
		, TAB.VACANCY_TITLE
		, TAB.VACANCY_TERM
		, TAB.REG_DT
		, TAB.JC_AGREE_YN
		, TAB.JC_AGREE_STS_CD
		, TAB.JC_AGREE_STS_NM
		, TAB.JC_AGREE_DT
		, TAB.VACANCY_STS_CD
		, TAB.VACANCY_STS_NM
		, TAB.RECRUMT_MEMB
		, TAB.APPLIC_CNT
		, TAB.PASS_CNT	
		, TAB.JC_CD	
		, TAB.JC_NM
		, TAB.ORDER_BY							
		FROM (
				SELECT
				A.VACANCY_SEQ
				, B.COMPNY_SEQ
				, A.VACANCY_ID
				, A.EMPLOY_FORM_CD
				, FN_GET_COMMON_NM('EMPLOY_FORM_CD', A.EMPLOY_FORM_CD, #{lang}) AS EMPLOY_FORM_NM
				, CASE WHEN #{lang} = 'kh' THEN B.COMPNY_NM_KH ELSE B.COMPNY_NM_EN END AS COMPNY_NM
				, A.VACANCY_TITLE
				, CONCAT(FN_GET_BASE_DATE_CHAR(A.BGN_DT, #{lang}), ' ~ ', FN_GET_BASE_DATE_CHAR(A.END_DT, #{lang})) AS VACANCY_TERM
				, FN_GET_BASE_DATE_TIME(A.REG_DT, 'I', #{lang}) AS REG_DT
				, A.JC_AGREE_YN
				, A.JC_AGREE_STS_CD
				, FN_GET_COMMON_NM('JC_AGREE_STS_CD', A.JC_AGREE_STS_CD, #{lang}) AS JC_AGREE_STS_NM
				, FN_GET_BASE_DATE_TIME(A.JC_AGREE_DT, 'I', #{lang}) AS JC_AGREE_DT
				, A.VACANCY_STS_CD
				, FN_GET_COMMON_NM('VACANCY_STS_CD', A.VACANCY_STS_CD, #{lang}) AS VACANCY_STS_NM
				, A.RECRUMT_MEMB
				, (SELECT COUNT(*) FROM CPES_APPLIC WHERE VACANCY_SEQ = A.VACANCY_SEQ) AS APPLIC_CNT
				, (SELECT COUNT(*) FROM CPES_APPLIC WHERE VACANCY_SEQ = A.VACANCY_SEQ AND APPLIC_PROC_CD = 'APC0000000004') AS PASS_CNT
				, A.JC_CD
				, CASE WHEN #{lang} = 'kh' THEN C.JC_KH ELSE C.JC_EN END AS JC_NM
				, A.REG_DT AS ORDER_BY
				FROM CPES_VACANCY A
				INNER JOIN CPES_COMPNY B
				ON A.COMPNY_SEQ 			= B.COMPNY_SEQ
				INNER JOIN CPES_JOB_CENTER C
				ON A.JC_CD 					= C.JC_CD
				LEFT JOIN CPES_VACANCY_PREFERNT_COND D
				ON A.VACANCY_SEQ 			= D.VACANCY_SEQ
				<where>
				    <if test="jcCd != null and jcCd != ''">
					AND A.JC_CD				LIKE CONCAT('%', #{jcCd}, '%') 
					</if>			
					<if test="compnyNm != null and compnyNm != '' and lang == 'kh'">
					AND B.COMPNY_NM_KH		LIKE CONCAT('%', #{compnyNm}, '%') 
					</if>
					<if test="compnyNm != null and compnyNm != '' and lang == 'en'">
					AND B.COMPNY_NM_EN		LIKE CONCAT('%', #{compnyNm}, '%') 
					</if>
					<if test="vacancyTitle != null and vacancyTitle != ''">
					AND A.VACANCY_TITLE		LIKE CONCAT('%', #{vacancyTitle}, '%') 
					</if>
					<if test="mngerTel != null and mngerTel != ''">
					AND B.MNGER_TEL			LIKE CONCAT('%', #{mngerTel}, '%') 
					</if>
					<if test="employFormCd != null and employFormCd != ''">
					AND A.EMPLOY_FORM_CD	LIKE CONCAT('%', #{employFormCd}, '%')
					</if>						
					<if test="vacancyStsCd != null and vacancyStsCd != ''">
					AND A.VACANCY_STS_CD	LIKE CONCAT('%', #{vacancyStsCd}, '%')
					</if>	
					<if test="jcAgreeStsCd != null and jcAgreeStsCd != ''">
					AND A.JC_AGREE_STS_CD	LIKE CONCAT('%', #{jcAgreeStsCd}, '%')
					</if>	
					<if test="vacancyPreferntCondCd != null and vacancyPreferntCondCd != ''">
					AND D.VACANCY_PREFERNT_COND_CD		LIKE CONCAT('%', #{vacancyPreferntCondCd}, '%')
					</if>											
					<if test="startDate != null and startDate != ''">
					<![CDATA[
					AND A.REG_DT			>= FN_GET_STR_TO_DATE(#{startDate}, 'S')
					]]>
					</if>
					<if test="endDate != null and endDate != ''">
					<![CDATA[			
					AND A.REG_DT			<= FN_GET_STR_TO_DATE(#{endDate}, 'E')
					]]>
					</if>
					AND A.DEL_YN			!= 'Y'												
				</where>
				GROUP BY 
				A.VACANCY_SEQ, B.COMPNY_SEQ, A.VACANCY_ID, A.EMPLOY_FORM_CD
				, B.COMPNY_NM_KH, B.COMPNY_NM_EN, A.VACANCY_TITLE, A.BGN_DT, A.END_DT
				, A.REG_DT, A.JC_AGREE_YN, A.JC_AGREE_STS_CD, A.JC_AGREE_DT, A.VACANCY_STS_CD
				, A.RECRUMT_MEMB, A.JC_CD
	    ) TAB
	    ,(SELECT @ROWNUM := 0) Z
		<choose>
			<when test="orderColumn == 'REG_DT'">
				ORDER BY TAB.ORDER_BY ${orderColumnSort}
			</when>
        	<otherwise>
            	ORDER BY ${orderColumn} ${orderColumnSort}
            </otherwise>

        </choose>
		<if test="length > -1">
		LIMIT 
			${start} , ${length}				
		</if>
            
    </select>
      
	<select id="selectJobskVacancyListTotalCnt" resultType="java.lang.Integer" parameterType="JobskVacancyBean">
       	SELECT COUNT(DISTINCT A.VACANCY_SEQ) AS TOTAL_COUNT
		FROM CPES_VACANCY A
		INNER JOIN CPES_COMPNY B
		ON A.COMPNY_SEQ 			= B.COMPNY_SEQ
		INNER JOIN CPES_JOB_CENTER C
		ON A.JC_CD 					= C.JC_CD
		LEFT JOIN CPES_VACANCY_PREFERNT_COND D
		ON A.VACANCY_SEQ 			= D.VACANCY_SEQ
		<where>
		    <if test="jcCd != null and jcCd != ''">
			AND A.JC_CD				LIKE CONCAT('%', #{jcCd}, '%') 
			</if>			
			<if test="compnyNm != null and compnyNm != '' and lang == 'kh'">
			AND B.COMPNY_NM_KH		LIKE CONCAT('%', #{compnyNm}, '%') 
			</if>
			<if test="compnyNm != null and compnyNm != '' and lang == 'en'">
			AND B.COMPNY_NM_EN		LIKE CONCAT('%', #{compnyNm}, '%') 
			</if>
			<if test="vacancyTitle != null and vacancyTitle != ''">
			AND A.VACANCY_TITLE		LIKE CONCAT('%', #{vacancyTitle}, '%') 
			</if>
			<if test="mngerTel != null and mngerTel != ''">
			AND B.MNGER_TEL			LIKE CONCAT('%', #{mngerTel}, '%') 
			</if>
			<if test="employFormCd != null and employFormCd != ''">
			AND A.EMPLOY_FORM_CD	LIKE CONCAT('%', #{employFormCd}, '%')
			</if>						
			<if test="vacancyStsCd != null and vacancyStsCd != ''">
			AND A.VACANCY_STS_CD	LIKE CONCAT('%', #{vacancyStsCd}, '%')
			</if>	
			<if test="jcAgreeStsCd != null and jcAgreeStsCd != ''">
			AND A.JC_AGREE_STS_CD	LIKE CONCAT('%', #{jcAgreeStsCd}, '%')
			</if>	
			<if test="vacancyPreferntCondCd != null and vacancyPreferntCondCd != ''">
			AND D.VACANCY_PREFERNT_COND_CD		LIKE CONCAT('%', #{vacancyPreferntCondCd}, '%')
			</if>											
			<if test="startDate != null and startDate != ''">
			<![CDATA[
			AND A.REG_DT			>= FN_GET_STR_TO_DATE(#{startDate}, 'S')
			]]>
			</if>
			<if test="endDate != null and endDate != ''">
			<![CDATA[			
			AND A.REG_DT			<= FN_GET_STR_TO_DATE(#{endDate}, 'E')
			]]>
			</if>		
			AND A.DEL_YN			!= 'Y'										
		</where>		
    </select>  

	<select id="selectJobskVacancyPreferntList" resultType="JobskVacancyPreferntBean" parameterType="JobskVacancyPreferntBean">
       	SELECT 
       	DTL_CD
       	, CASE WHEN #{lang} = 'kh' THEN CD_KH_NM ELSE CD_EN_NM END AS CD_NM
       	FROM CPES_COMMON_DTL_CD
		<where>
		    <if test="grpCd != null and grpCd != ''">
			AND GRP_CD				LIKE CONCAT('%', #{grpCd}, '%') 
			</if>			
		</where>
		ORDER BY DTL_CD ASC	
    </select> 

	<select id="selectJobskApplicList" resultType="JobskApplicBean" parameterType="JobskApplicBean">
		SELECT
		${totalCount} - ((${pageNo} - 1) * ${length}) - (@ROWNUM := @ROWNUM + 1) + 1 AS ROW_NUM 
		, TAB.VACANCY_SEQ
		, TAB.RESUME_SEQ
		, TAB.COMPNY_SEQ
		, TAB.USER_SEQ
		, TAB.USER_AUTH_CD
		, TAB.USER_AUTH_NM
		, TAB.USER_NM
		, TAB.RESUME_TITLE
		, TAB.USER_EMAIL
		, TAB.AGE
		, TAB.EMPLOY_FORM_CD
		, TAB.EMPLOY_FORM_NM
		, TAB.VACANCY_TITLE
		, TAB.COMPNY_NM
		, TAB.MNGER_TEL
		, TAB.MNGER_EMAIL
		, TAB.REG_DT
		, TAB.RESUME_OPEN_DT
		, TAB.EMAIL_NTCE_YN
		, TAB.REFERRAL_YN
		, TAB.APPLIC_TYPE_CD
		, TAB.APPLIC_TYPE_NM
		, TAB.ORDER_BY										
		FROM (
				SELECT
				A.VACANCY_SEQ
				, B.RESUME_SEQ
				, D.COMPNY_SEQ
				, E.USER_SEQ
				, E.USER_AUTH_CD
				, FN_GET_COMMON_NM('USER_AUTH_CD', E.USER_AUTH_CD, #{lang}) AS USER_AUTH_NM
				, CASE WHEN '' = 'kh' THEN E.USER_NM_KH ELSE E.USER_NM_EN END AS USER_NM
				, B.RESUME_TITLE
				, E.USER_EMAIL
				, FLOOR((CAST(REPLACE(CURRENT_DATE,'-',#{lang}) AS UNSIGNED) - 
				       		CAST(REPLACE(B.BIRTH,'-',#{lang}) AS UNSIGNED)) / 10000 ) AS AGE
				, C.EMPLOY_FORM_CD
				, FN_GET_COMMON_NM('EMPLOY_FORM_CD', C.EMPLOY_FORM_CD, #{lang}) AS EMPLOY_FORM_NM
				, C.VACANCY_TITLE
				, CASE WHEN #{lang} = 'kh' THEN D.COMPNY_NM_KH ELSE D.COMPNY_NM_EN END AS COMPNY_NM
				, D.MNGER_TEL
				, D.MNGER_EMAIL
				, FN_GET_BASE_DATE_TIME(A.REG_DT, 'I', #{lang}) AS REG_DT
				, CASE WHEN A.APPLIC_PROC_CD != 'APC0000000001' THEN FN_GET_BASE_DATE_TIME(A.RESUME_OPEN_DT, 'I', #{lang}) ELSE '' END AS RESUME_OPEN_DT
				, F.EMAIL_NTCE_YN
				, A.REFERRAL_YN
				, A.APPLIC_TYPE_CD
				, FN_GET_COMMON_NM('APPLIC_TYPE_CD', A.APPLIC_TYPE_CD, #{lang}) AS APPLIC_TYPE_NM
				, A.REG_DT AS ORDER_BY
				FROM CPES_APPLIC A
				INNER JOIN CPES_RESUME B
				ON A.RESUME_SEQ 			= B.RESUME_SEQ
				INNER JOIN CPES_VACANCY C
				ON A.VACANCY_SEQ 			= C.VACANCY_SEQ
				INNER JOIN CPES_COMPNY D
				ON C.COMPNY_SEQ 			= D.COMPNY_SEQ
				INNER JOIN CPES_USER E
				ON B.USER_SEQ 				= E.USER_SEQ
				LEFT JOIN CPES_REFERRAL F
				ON C.VACANCY_SEQ 			= F.VACANCY_SEQ
				LEFT JOIN CPES_VACANCY_PREFERNT_COND G
				ON C.VACANCY_SEQ 			= G.VACANCY_SEQ		
				<where>
				    <if test="jcCd != null and jcCd != ''">
					AND E.JC_CD				LIKE CONCAT('%', #{jcCd}, '%') 
					</if>	
					<if test="userNm != null and userNm != '' and lang == 'kh'">
					AND E.USER_NM_KH		LIKE CONCAT('%', #{userNm}, '%') 
					</if>
					<if test="compnyNm != null and compnyNm != '' and lang == 'en'">
					AND E.USER_NM_EN		LIKE CONCAT('%', #{userNm}, '%') 
					</if>								
					<if test="compnyNm != null and compnyNm != '' and lang == 'kh'">
					AND D.COMPNY_NM_KH		LIKE CONCAT('%', #{compnyNm}, '%') 
					</if>
					<if test="compnyNm != null and compnyNm != '' and lang == 'en'">
					AND D.COMPNY_NM_EN		LIKE CONCAT('%', #{compnyNm}, '%') 
					</if>
					<if test="resumeTitle != null and resumeTitle != ''">
					AND B.RESUME_TITLE		LIKE CONCAT('%', #{resumeTitle}, '%') 
					</if>
					<if test="vacancyTitle != null and vacancyTitle != ''">
					AND C.VACANCY_TITLE		LIKE CONCAT('%', #{vacancyTitle}, '%') 
					</if>
					<if test="userTel != null and userTel != ''">
					AND E.USER_TEL		LIKE CONCAT('%', #{userCell}, '%') 
					</if>
					<if test="userEmail != null and userEmail != ''">
					AND E.USER_EMAIL		LIKE CONCAT('%', #{userEmail}, '%') 
					</if>						
					<if test="userAuthCd != null and userAuthCd != ''">
					AND E.USER_AUTH_CD		LIKE CONCAT('%', #{userAuthCd}, '%') 
					</if>
					<if test="genderCd != null and genderCd != ''">
					AND E.GENDER_CD			LIKE CONCAT('%', #{genderCd}, '%') 
					</if>
					<if test="employFormCd != null and employFormCd != ''">
					AND C.EMPLOY_FORM_CD	LIKE CONCAT('%', #{employFormCd}, '%') 
					</if>
					<if test="vacancyPreferntCd != null and vacancyPreferntCd != ''">
					AND G.PREFERNT_COND_CD	IN (#{vacancyPreferntCd}) 
					</if>
					<if test="resumeOpenYn != null and resumeOpenYn != ''">
						<choose>
							<when test="resumeOpenYn != 'Y'">
							AND A.APPLIC_PROC_CD = 'APC0000000001'
							</when>
							<otherwise>
							AND A.APPLIC_PROC_CD != 'APC0000000001' 
							</otherwise> 
						</choose> 
					</if>
					<if test="applicTypeCd != null and applicTypeCd != ''">
					AND A.APPLIC_TYPE_CD	LIKE CONCAT('%', #{applicTypeCd}, '%') 
					</if>
					<if test="referralYn != null and referralYn != ''">
					AND A.REFERRAL_YN		LIKE CONCAT('%', #{referralYn}, '%') 
					</if>
					<if test="startDate != null and startDate != ''">
					<![CDATA[
					AND A.REG_DT			>= FN_GET_STR_TO_DATE(#{startDate}, 'S')
					]]>
					</if>
					<if test="endDate != null and endDate != ''">
					<![CDATA[			
					AND A.REG_DT			<= FN_GET_STR_TO_DATE(#{endDate}, 'E')
					]]>
					</if>												
				</where>
				GROUP BY
				A.VACANCY_SEQ, B.RESUME_SEQ, D.COMPNY_SEQ, E.USER_SEQ, E.USER_AUTH_CD
				, E.USER_NM_KH, E.USER_NM_EN, B.RESUME_TITLE, E.USER_EMAIL, B.BIRTH
				, C.EMPLOY_FORM_CD, C.VACANCY_TITLE, D.COMPNY_NM_KH, D.COMPNY_NM_EN, D.MNGER_TEL
				, D.MNGER_EMAIL, A.REG_DT, A.RESUME_OPEN_DT, F.EMAIL_NTCE_YN
				, A.REFERRAL_YN, A.APPLIC_TYPE_CD
		) TAB
		, (SELECT @ROWNUM := 0) Z
		<choose>
			<when test="orderColumn == 'REG_DT'">
				ORDER BY TAB.ORDER_BY ${orderColumnSort}
			</when>
        	<otherwise>
            	ORDER BY ${orderColumn} ${orderColumnSort}
            </otherwise>

        </choose>		
		<if test="length > -1">
		LIMIT 
			${start} , ${length}				
		</if>
            
    </select>
      
	<select id="selectJobskApplicListTotalCnt" resultType="java.lang.Integer" parameterType="JobskApplicBean">
       	SELECT COUNT(DISTINCT A.VACANCY_SEQ) AS TOTAL_COUNT
		FROM CPES_APPLIC A
		INNER JOIN CPES_RESUME B
		ON A.RESUME_SEQ 			= B.RESUME_SEQ
		INNER JOIN CPES_VACANCY C
		ON A.VACANCY_SEQ 			= C.VACANCY_SEQ
		INNER JOIN CPES_COMPNY D
		ON C.COMPNY_SEQ 			= D.COMPNY_SEQ
		INNER JOIN CPES_USER E
		ON B.USER_SEQ 				= E.USER_SEQ
		LEFT JOIN CPES_REFERRAL F
		ON C.VACANCY_SEQ 			= F.VACANCY_SEQ
		LEFT JOIN CPES_VACANCY_PREFERNT_COND G
		ON C.VACANCY_SEQ 			= G.VACANCY_SEQ		       	
		<where>
		    <if test="jcCd != null and jcCd != ''">
			AND E.JC_CD				LIKE CONCAT('%', #{jcCd}, '%') 
			</if>	
			<if test="userNm != null and userNm != '' and lang == 'kh'">
			AND E.USER_NM_KH		LIKE CONCAT('%', #{userNm}, '%') 
			</if>
			<if test="compnyNm != null and compnyNm != '' and lang == 'en'">
			AND E.USER_NM_EN		LIKE CONCAT('%', #{userNm}, '%') 
			</if>								
			<if test="compnyNm != null and compnyNm != '' and lang == 'kh'">
			AND D.COMPNY_NM_KH		LIKE CONCAT('%', #{compnyNm}, '%') 
			</if>
			<if test="compnyNm != null and compnyNm != '' and lang == 'en'">
			AND D.COMPNY_NM_EN		LIKE CONCAT('%', #{compnyNm}, '%') 
			</if>
			<if test="resumeTitle != null and resumeTitle != ''">
			AND B.RESUME_TITLE		LIKE CONCAT('%', #{resumeTitle}, '%') 
			</if>
			<if test="vacancyTitle != null and vacancyTitle != ''">
			AND C.VACANCY_TITLE		LIKE CONCAT('%', #{vacancyTitle}, '%') 
			</if>
			<if test="userTel != null and userTel != ''">
			AND E.USER_TEL		LIKE CONCAT('%', #{userCell}, '%') 
			</if>
			<if test="userEmail != null and userEmail != ''">
			AND E.USER_EMAIL		LIKE CONCAT('%', #{userEmail}, '%') 
			</if>						
			<if test="userAuthCd != null and userAuthCd != ''">
			AND E.USER_AUTH_CD		LIKE CONCAT('%', #{userAuthCd}, '%') 
			</if>
			<if test="genderCd != null and genderCd != ''">
			AND E.GENDER_CD			LIKE CONCAT('%', #{genderCd}, '%') 
			</if>
			<if test="employFormCd != null and employFormCd != ''">
			AND C.EMPLOY_FORM_CD	LIKE CONCAT('%', #{employFormCd}, '%') 
			</if>
			<if test="vacancyPreferntCd != null and vacancyPreferntCd != ''">
			AND G.PREFERNT_COND_CD	IN (#{vacancyPreferntCd}) 
			</if>
			<if test="resumeOpenYn != null and resumeOpenYn != ''">
				<choose>
					<when test="resumeOpenYn != 'Y'">
					AND A.APPLIC_PROC_CD = 'APC0000000001'
					</when>
					<otherwise>
					AND A.APPLIC_PROC_CD != 'APC0000000001' 
					</otherwise> 
				</choose> 
			</if>
			<if test="applicTypeCd != null and applicTypeCd != ''">
			AND A.APPLIC_TYPE_CD	LIKE CONCAT('%', #{applicTypeCd}, '%') 
			</if>
			<if test="referralYn != null and referralYn != ''">
			AND A.REFERRAL_YN		LIKE CONCAT('%', #{referralYn}, '%') 
			</if>
			<if test="startDate != null and startDate != ''">
			<![CDATA[
			AND A.REG_DT			>= FN_GET_STR_TO_DATE(#{startDate}, 'S')
			]]>
			</if>
			<if test="endDate != null and endDate != ''">
			<![CDATA[			
			AND A.REG_DT			<= FN_GET_STR_TO_DATE(#{endDate}, 'E')
			]]>
			</if>												
		</where>	
    </select> 

	<select id="selectJobskOfferList" resultType="JobskOfferBean" parameterType="JobskOfferBean">
		SELECT
		${totalCount} - ((${pageNo} - 1) * ${length}) - (@ROWNUM := @ROWNUM + 1) + 1 AS ROW_NUM 
		, TAB.COMPNY_SEQ
		, TAB.RESUME_SEQ
		, TAB.VACANCY_SEQ
		, TAB.USER_SEQ
		, TAB.COMPNY_NM
		, TAB.EMPLOY_FORM_CD
		, TAB.EMPLOY_FORM_NM
		, TAB.VACANCY_TITLE
		, TAB.MNGER_EMAIL
		, TAB.MNGER_CELL
		, TAB.USER_AUTH_CD
		, TAB.USER_AUTH_NM
		, TAB.USER_NM
		, TAB.USER_EMAIL
		, TAB.USER_TEL
		, TAB.REG_DT	
		, TAB.OFFER_ACPT_YN
		, TAB.OFFER_ACPT_DT
		, TAB.EMAIL_NTCE_YN
		, TAB.REFERRAL_YN
		, TAB.ORDER_BY			  		
		FROM (
				SELECT
				D.COMPNY_SEQ
				, B.RESUME_SEQ
				, C.VACANCY_SEQ
				, E.USER_SEQ
				, CASE WHEN #{lang} = 'kh' THEN D.COMPNY_NM_KH ELSE D.COMPNY_NM_EN END AS COMPNY_NM
				, C.EMPLOY_FORM_CD
				, FN_GET_COMMON_NM('EMPLOY_FORM_CD', C.EMPLOY_FORM_CD, #{lang}) AS EMPLOY_FORM_NM
				, C.VACANCY_TITLE
				, C.MNGER_EMAIL
				, C.MNGER_CELL
				, E.USER_AUTH_CD
				, FN_GET_COMMON_NM('USER_AUTH_CD', E.USER_AUTH_CD, #{lang}) AS USER_AUTH_NM
				, CASE WHEN #{lang} = 'kh' THEN E.USER_NM_KH ELSE E.USER_NM_EN END AS USER_NM
				, E.USER_EMAIL
				, E.USER_TEL
				, FN_GET_BASE_DATE_TIME(A.REG_DT, 'I', #{lang}) AS REG_DT
				, A.OFFER_ACPT_YN
				, FN_GET_BASE_DATE_CHAR(A.OFFER_ACPT_DT, #{lang}) AS OFFER_ACPT_DT
				, A.EMAIL_NTCE_YN
				, A.REFERRAL_YN
				, A.REG_DT AS ORDER_BY
				FROM CPES_OFFER A
				INNER JOIN CPES_RESUME B
				ON A.RESUME_SEQ 		= B.RESUME_SEQ
				INNER JOIN CPES_VACANCY C
				ON A.VACANCY_SEQ 		= C.VACANCY_SEQ
				INNER JOIN CPES_COMPNY D
				ON C.COMPNY_SEQ 		= D.COMPNY_SEQ
				INNER JOIN CPES_USER E
				ON B.USER_SEQ 			= E.USER_SEQ
				LEFT JOIN CPES_VACANCY_PREFERNT_COND F
				ON C.VACANCY_SEQ 		= F.VACANCY_SEQ
				<where>
				    <if test="jcCd != null and jcCd != ''">
					AND E.JC_CD				LIKE CONCAT('%', #{jcCd}, '%') 
					</if>	
					<if test="userNm != null and userNm != '' and lang == 'kh'">
					AND E.USER_NM_KH		LIKE CONCAT('%', #{userNm}, '%') 
					</if>
					<if test="compnyNm != null and compnyNm != '' and lang == 'en'">
					AND E.USER_NM_EN		LIKE CONCAT('%', #{userNm}, '%') 
					</if>								
					<if test="compnyNm != null and compnyNm != '' and lang == 'kh'">
					AND D.COMPNY_NM_KH		LIKE CONCAT('%', #{compnyNm}, '%') 
					</if>
					<if test="compnyNm != null and compnyNm != '' and lang == 'en'">
					AND D.COMPNY_NM_EN		LIKE CONCAT('%', #{compnyNm}, '%') 
					</if>
					<if test="resumeTitle != null and resumeTitle != ''">
					AND B.RESUME_TITLE		LIKE CONCAT('%', #{resumeTitle}, '%') 
					</if>
					<if test="vacancyTitle != null and vacancyTitle != ''">
					AND C.VACANCY_TITLE		LIKE CONCAT('%', #{vacancyTitle}, '%') 
					</if>
					<if test="userTel != null and userTel != ''">
					AND E.USER_TEL			LIKE CONCAT('%', #{userCell}, '%') 
					</if>
					<if test="userEmail != null and userEmail != ''">
					AND E.USER_EMAIL		LIKE CONCAT('%', #{userEmail}, '%') 
					</if>						
					<if test="userAuthCd != null and userAuthCd != ''">
					AND E.USER_AUTH_CD		LIKE CONCAT('%', #{userAuthCd}, '%') 
					</if>
					<if test="genderCd != null and genderCd != ''">
					AND E.GENDER_CD			LIKE CONCAT('%', #{genderCd}, '%') 
					</if>
					<if test="employFormCd != null and employFormCd != ''">
					AND C.EMPLOY_FORM_CD	LIKE CONCAT('%', #{employFormCd}, '%') 
					</if>
					<if test="vacancyPreferntCd != null and vacancyPreferntCd != ''">
					AND F.PREFERNT_COND_CD	IN (#{vacancyPreferntCd}) 
					</if>
					<if test="offerAcptYn != null and offerAcptYn != ''">
					AND A.OFFER_ACPT_YN		LIKE CONCAT('%', #{offerAcptYn}, '%') 
					</if>						
					<if test="referralYn != null and referralYn != ''">
					AND A.REFERRAL_YN		LIKE CONCAT('%', #{referralYn}, '%')
					</if>															
					<if test="startDate != null and startDate != ''">
					<![CDATA[
					AND A.REG_DT			>= FN_GET_STR_TO_DATE(#{startDate}, 'S')
					]]>
					</if>
					<if test="endDate != null and endDate != ''">
					<![CDATA[			
					AND A.REG_DT			<= FN_GET_STR_TO_DATE(#{endDate}, 'E')
					]]>
					</if>												
				</where>
				GROUP BY
				C.COMPNY_SEQ, B.RESUME_SEQ, C.VACANCY_SEQ, D.COMPNY_NM_KH, D.COMPNY_NM_EN
				, C.EMPLOY_FORM_CD, C.VACANCY_TITLE, C.MNGER_EMAIL, C.MNGER_CELL, E.USER_AUTH_CD
				, E.USER_NM_KH, E.USER_NM_EN, E.USER_EMAIL, E.USER_CELL, A.REG_DT
				, A.OFFER_ACPT_YN, A.OFFER_OPEN_DT, A.EMAIL_NTCE_YN, A.REFERRAL_YN
		) TAB
		, (SELECT @ROWNUM := 0) Z
		<choose>
			<when test="orderColumn == 'REG_DT'">
				ORDER BY TAB.ORDER_BY ${orderColumnSort}
			</when>
        	<otherwise>
            	ORDER BY ${orderColumn} ${orderColumnSort}
            </otherwise>

        </choose>
		<if test="length > -1">
		LIMIT 
			${start} , ${length}				
		</if>
            
    </select>
      
	<select id="selectJobskOfferListTotalCnt" resultType="java.lang.Integer" parameterType="JobskOfferBean">
       	SELECT COUNT(DISTINCT C.VACANCY_SEQ) AS TOTAL_COUNT
		FROM CPES_OFFER A
		INNER JOIN CPES_RESUME B
		ON A.RESUME_SEQ 		= B.RESUME_SEQ
		INNER JOIN CPES_VACANCY C
		ON A.VACANCY_SEQ 		= C.VACANCY_SEQ
		INNER JOIN CPES_COMPNY D
		ON C.COMPNY_SEQ 		= D.COMPNY_SEQ
		INNER JOIN CPES_USER E
		ON B.USER_SEQ 			= E.USER_SEQ
		LEFT JOIN CPES_VACANCY_PREFERNT_COND F
		ON C.VACANCY_SEQ 		= F.VACANCY_SEQ
		, (SELECT @ROWNUM := 0) Z
		<where>
		    <if test="jcCd != null and jcCd != ''">
			AND E.JC_CD				LIKE CONCAT('%', #{jcCd}, '%') 
			</if>	
			<if test="userNm != null and userNm != '' and lang == 'kh'">
			AND E.USER_NM_KH		LIKE CONCAT('%', #{userNm}, '%') 
			</if>
			<if test="compnyNm != null and compnyNm != '' and lang == 'en'">
			AND E.USER_NM_EN		LIKE CONCAT('%', #{userNm}, '%') 
			</if>								
			<if test="compnyNm != null and compnyNm != '' and lang == 'kh'">
			AND D.COMPNY_NM_KH		LIKE CONCAT('%', #{compnyNm}, '%') 
			</if>
			<if test="compnyNm != null and compnyNm != '' and lang == 'en'">
			AND D.COMPNY_NM_EN		LIKE CONCAT('%', #{compnyNm}, '%') 
			</if>
			<if test="resumeTitle != null and resumeTitle != ''">
			AND B.RESUME_TITLE		LIKE CONCAT('%', #{resumeTitle}, '%') 
			</if>
			<if test="vacancyTitle != null and vacancyTitle != ''">
			AND C.VACANCY_TITLE		LIKE CONCAT('%', #{vacancyTitle}, '%') 
			</if>
			<if test="userTel != null and userTel != ''">
			AND E.USER_TEL			LIKE CONCAT('%', #{userCell}, '%') 
			</if>
			<if test="userEmail != null and userEmail != ''">
			AND E.USER_EMAIL		LIKE CONCAT('%', #{userEmail}, '%') 
			</if>						
			<if test="userAuthCd != null and userAuthCd != ''">
			AND E.USER_AUTH_CD		LIKE CONCAT('%', #{userAuthCd}, '%') 
			</if>
			<if test="genderCd != null and genderCd != ''">
			AND E.GENDER_CD			LIKE CONCAT('%', #{genderCd}, '%') 
			</if>
			<if test="employFormCd != null and employFormCd != ''">
			AND C.EMPLOY_FORM_CD	LIKE CONCAT('%', #{employFormCd}, '%') 
			</if>
			<if test="vacancyPreferntCd != null and vacancyPreferntCd != ''">
			AND F.PREFERNT_COND_CD	IN (#{vacancyPreferntCd}) 
			</if>
			<if test="offerAcptYn != null and offerAcptYn != ''">
			AND A.OFFER_ACPT_YN		LIKE CONCAT('%', #{offerAcptYn}, '%') 
			</if>						
			<if test="referralYn != null and referralYn != ''">
			AND A.REFERRAL_YN		LIKE CONCAT('%', #{referralYn}, '%')
			</if>															
			<if test="startDate != null and startDate != ''">
			<![CDATA[
			AND A.REG_DT			>= FN_GET_STR_TO_DATE(#{startDate}, 'S')
			]]>
			</if>
			<if test="endDate != null and endDate != ''">
			<![CDATA[			
			AND A.REG_DT			<= FN_GET_STR_TO_DATE(#{endDate}, 'E')
			]]>
			</if>												
		</where>		
    </select>

	<select id="selectJobskIntvwList" resultType="JobskIntvwBean" parameterType="JobskIntvwBean">
		SELECT
		${totalCount} - ((${pageNo} - 1) * ${length}) - (@ROWNUM := @ROWNUM + 1) + 1 AS ROW_NUM 
		, TAB.COMPNY_SEQ
		, TAB.RESUME_SEQ
		, TAB.USER_SEQ
		, TAB.VACANCY_SEQ
		, TAB.COMPNY_NM
		, TAB.EMPLOY_FORM_CD  
		, TAB.EMPLOY_FORM_NM
		, TAB.VACANCY_TITLE
		, TAB.MNGER_EMAIL
		, TAB.MNGER_TEL
		, TAB.USER_AUTH_CD
		, TAB.USER_AUTH_NM
		, TAB.USER_NM
		, TAB.USER_EMAIL
		, TAB.USER_TEL
		, TAB.REG_DT
		, TAB.INTVW_TYPE_CD
		, TAB.INTVW_TYPE_NM	
		, TAB.INTVW_OPEN_YN	
		, TAB.INTVW_OPEN_DT	
		, TAB.REFERRAL_YN	
		, TAB.ORDER_BY 		
		FROM (
				SELECT
				E.COMPNY_SEQ
				, C.RESUME_SEQ
				, F.USER_SEQ
				, D.VACANCY_SEQ
				, CASE WHEN #{lang} = 'kh' THEN E.COMPNY_NM_KH ELSE E.COMPNY_NM_EN END AS COMPNY_NM
				, D.EMPLOY_FORM_CD
				, FN_GET_COMMON_NM('EMPLOY_FORM_CD', D.EMPLOY_FORM_CD, #{lang}) AS EMPLOY_FORM_NM
				, D.VACANCY_TITLE
				, E.MNGER_EMAIL
				, E.MNGER_TEL
				, F.USER_AUTH_CD
				, FN_GET_COMMON_NM('USER_AUTH_CD', F.USER_AUTH_CD, #{lang}) AS USER_AUTH_NM
				, CASE WHEN #{lang} = 'kh' THEN F.USER_NM_KH ELSE F.USER_NM_EN END AS USER_NM
				, F.USER_EMAIL
				, F.USER_TEL
				, FN_GET_BASE_DATE_CHAR(A.REG_DT, #{lang}) AS REG_DT
				, A.INTVW_TYPE_CD
				, FN_GET_COMMON_NM('INTVW_TYPE_CD', A.INTVW_TYPE_CD, #{lang}) AS INTVW_TYPE_NM
				, A.INTVW_OPEN_YN
				, FN_GET_BASE_DATE_CHAR(A.INTVW_OPEN_DT, #{lang}) AS INTVW_OPEN_DT
				, A.REFERRAL_YN
				, A.REG_DT AS ORDER_BY
				FROM CPES_INTVW A
				INNER JOIN CPES_APPLIC B
				ON A.APPLIC_SEQ = B.APPLIC_SEQ
				INNER JOIN CPES_RESUME C
				ON B.RESUME_SEQ = C.RESUME_SEQ
				INNER JOIN CPES_VACANCY D
				ON B.VACANCY_SEQ = D.VACANCY_SEQ
				INNER JOIN CPES_COMPNY E
				ON D.COMPNY_SEQ = E.COMPNY_SEQ
				INNER JOIN CPES_USER F
				ON C.USER_SEQ = F.USER_SEQ
				LEFT JOIN CPES_VACANCY_PREFERNT_COND G
				ON D.VACANCY_SEQ = G.VACANCY_SEQ
				<where>
				    <if test="jcCd != null and jcCd != ''">
					AND F.JC_CD				LIKE CONCAT('%', #{jcCd}, '%') 
					</if>	
					<if test="userNm != null and userNm != '' and lang == 'kh'">
					AND F.USER_NM_KH		LIKE CONCAT('%', #{userNm}, '%') 
					</if>
					<if test="userNm != null and userNm != '' and lang == 'en'">
					AND F.USER_NM_EN		LIKE CONCAT('%', #{userNm}, '%') 
					</if>								
					<if test="compnyNm != null and compnyNm != '' and lang == 'kh'">
					AND E.COMPNY_NM_KH		LIKE CONCAT('%', #{compnyNm}, '%') 
					</if>
					<if test="compnyNm != null and compnyNm != '' and lang == 'en'">
					AND E.COMPNY_NM_EN		LIKE CONCAT('%', #{compnyNm}, '%') 
					</if>
					<if test="resumeTitle != null and resumeTitle != ''">
					AND C.RESUME_TITLE		LIKE CONCAT('%', #{resumeTitle}, '%') 
					</if>
					<if test="vacancyTitle != null and vacancyTitle != ''">
					AND D.VACANCY_TITLE		LIKE CONCAT('%', #{vacancyTitle}, '%') 
					</if>
					<if test="userTel != null and userTel != ''">
					AND F.USER_TEL			LIKE CONCAT('%', #{userTel}, '%') 
					</if>
					<if test="userEmail != null and userEmail != ''">
					AND F.USER_EMAIL		LIKE CONCAT('%', #{userEmail}, '%') 
					</if>						
					<if test="userAuthCd != null and userAuthCd != ''">
					AND F.USER_AUTH_CD		LIKE CONCAT('%', #{userAuthCd}, '%') 
					</if>
					<if test="genderCd != null and genderCd != ''">
					AND F.GENDER_CD			LIKE CONCAT('%', #{genderCd}, '%') 
					</if>
					<if test="employFormCd != null and employFormCd != ''">
					AND D.EMPLOY_FORM_CD	LIKE CONCAT('%', #{employFormCd}, '%') 
					</if>
					<if test="vacancyPreferntCd != null and vacancyPreferntCd != ''">
					AND G.PREFERNT_COND_CD	IN (#{vacancyPreferntCd}) 
					</if>
					<if test="intvwTypeCd != null and intvwTypeCd != ''">
					AND A.INTVW_TYPE_CD		LIKE CONCAT('%', #{intvwTypeCd}, '%') 
					</if>						
					<if test="referralYn != null and referralYn != ''">
					AND A.REFERRAL_YN		LIKE CONCAT('%', #{referralYn}, '%')
					</if>															
					<if test="startDate != null and startDate != ''">
					<![CDATA[
					AND A.REG_DT			>= FN_GET_STR_TO_DATE(#{startDate}, 'S')
					]]>
					</if>
					<if test="endDate != null and endDate != ''">
					<![CDATA[			
					AND A.REG_DT			<= FN_GET_STR_TO_DATE(#{endDate}, 'E')
					]]>
					</if>												
				</where>
				GROUP BY
				E.COMPNY_SEQ, C.RESUME_SEQ, F.USER_SEQ, D.VACANCY_SEQ, E.COMPNY_NM_KH
				, E.COMPNY_NM_EN, D.EMPLOY_FORM_CD, D.VACANCY_TITLE, E.MNGER_EMAIL, E.MNGER_TEL
				, F.USER_AUTH_CD, F.USER_NM_KH, F.USER_NM_EN, F.USER_EMAIL, F.USER_TEL
				, A.REG_DT, A.INTVW_TYPE_CD, A.INTVW_OPEN_YN, A.INTVW_OPEN_DT, A.REFERRAL_YN
		) TAB
		, (SELECT @ROWNUM := 0) Z
		<choose>
			<when test="orderColumn == 'REG_DT'">
				ORDER BY TAB.ORDER_BY ${orderColumnSort}
			</when>
        	<otherwise>
            	ORDER BY ${orderColumn} ${orderColumnSort}
            </otherwise>

        </choose>
		<if test="length > -1">
		LIMIT 
			${start} , ${length}				
		</if>
            
    </select>
      
	<select id="selectJobskIntvwListTotalCnt" resultType="java.lang.Integer" parameterType="JobskIntvwBean">
       	SELECT COUNT(DISTINCT D.VACANCY_SEQ) AS TOTAL_COUNT
		FROM CPES_INTVW A
		INNER JOIN CPES_APPLIC B
		ON A.APPLIC_SEQ = B.APPLIC_SEQ
		INNER JOIN CPES_RESUME C
		ON B.RESUME_SEQ = C.RESUME_SEQ
		INNER JOIN CPES_VACANCY D
		ON B.VACANCY_SEQ = D.VACANCY_SEQ
		INNER JOIN CPES_COMPNY E
		ON D.COMPNY_SEQ = E.COMPNY_SEQ
		INNER JOIN CPES_USER F
		ON C.USER_SEQ = F.USER_SEQ
		LEFT JOIN CPES_VACANCY_PREFERNT_COND G
		ON D.VACANCY_SEQ = G.VACANCY_SEQ
		<where>
		    <if test="jcCd != null and jcCd != ''">
			AND F.JC_CD				LIKE CONCAT('%', #{jcCd}, '%') 
			</if>	
			<if test="userNm != null and userNm != '' and lang == 'kh'">
			AND F.USER_NM_KH		LIKE CONCAT('%', #{userNm}, '%') 
			</if>
			<if test="userNm != null and userNm != '' and lang == 'en'">
			AND F.USER_NM_EN		LIKE CONCAT('%', #{userNm}, '%') 
			</if>								
			<if test="compnyNm != null and compnyNm != '' and lang == 'kh'">
			AND E.COMPNY_NM_KH		LIKE CONCAT('%', #{compnyNm}, '%') 
			</if>
			<if test="compnyNm != null and compnyNm != '' and lang == 'en'">
			AND E.COMPNY_NM_EN		LIKE CONCAT('%', #{compnyNm}, '%') 
			</if>
			<if test="resumeTitle != null and resumeTitle != ''">
			AND C.RESUME_TITLE		LIKE CONCAT('%', #{resumeTitle}, '%') 
			</if>
			<if test="vacancyTitle != null and vacancyTitle != ''">
			AND D.VACANCY_TITLE		LIKE CONCAT('%', #{vacancyTitle}, '%') 
			</if>
			<if test="userTel != null and userTel != ''">
			AND F.USER_TEL			LIKE CONCAT('%', #{userTel}, '%') 
			</if>
			<if test="userEmail != null and userEmail != ''">
			AND F.USER_EMAIL		LIKE CONCAT('%', #{userEmail}, '%') 
			</if>						
			<if test="userAuthCd != null and userAuthCd != ''">
			AND F.USER_AUTH_CD		LIKE CONCAT('%', #{userAuthCd}, '%') 
			</if>
			<if test="genderCd != null and genderCd != ''">
			AND F.GENDER_CD			LIKE CONCAT('%', #{genderCd}, '%') 
			</if>
			<if test="employFormCd != null and employFormCd != ''">
			AND D.EMPLOY_FORM_CD	LIKE CONCAT('%', #{employFormCd}, '%') 
			</if>
			<if test="vacancyPreferntCd != null and vacancyPreferntCd != ''">
			AND G.PREFERNT_COND_CD	IN (#{vacancyPreferntCd}) 
			</if>
			<if test="intvwTypeCd != null and intvwTypeCd != ''">
			AND A.INTVW_TYPE_CD		LIKE CONCAT('%', #{intvwTypeCd}, '%') 
			</if>						
			<if test="referralYn != null and referralYn != ''">
			AND A.REFERRAL_YN		LIKE CONCAT('%', #{referralYn}, '%')
			</if>															
			<if test="startDate != null and startDate != ''">
			<![CDATA[
			AND A.REG_DT			>= FN_GET_STR_TO_DATE(#{startDate}, 'S')
			]]>
			</if>
			<if test="endDate != null and endDate != ''">
			<![CDATA[			
			AND A.REG_DT			<= FN_GET_STR_TO_DATE(#{endDate}, 'E')
			]]>
			</if>												
		</where>		
    </select>

	<select id="selectJobskVdoIntvwList" resultType="JobskVdoIntvwBean" parameterType="JobskVdoIntvwBean">
		SELECT
		${totalCount} - ((${pageNo} - 1) * ${length}) - (@ROWNUM := @ROWNUM + 1) + 1 AS ROW_NUM 
		, TAB.VIDEO_INTVW_SEQ
		, TAB.COMPNY_SEQ
		, TAB.USER_SEQ
		, TAB.COMPNY_NM
		, TAB.MNGER_TEL
		, TAB.COMPNY_JC_CD
		, TAB.COMPNY_JC_NM
		, TAB.USER_AUTH_CD
		, TAB.USER_AUTH_NM
		, TAB.USER_NM
		, TAB.USER_TEL
		, TAB.USER_JC_CD
		, TAB.USER_JC_NM
		, TAB.REG_DT
		, TAB.JC_AGREE_STS_CD
		, TAB.JC_AGREE_STS_NM
		, TAB.INTVW_MNGER
		, TAB.MNGER_USER_NM
		, TAB.ORDER_BY
		FROM (
				SELECT
				A.VIDEO_INTVW_SEQ
				, C.COMPNY_SEQ
				, D.USER_SEQ
				, CASE WHEN #{lang} = 'kh' THEN C.COMPNY_NM_KH ELSE C.COMPNY_NM_EN END AS COMPNY_NM
				, C.MNGER_TEL
				, A.JC_CD AS COMPNY_JC_CD
				, CASE WHEN #{lang} = 'kh' THEN E.JC_KH ELSE E.JC_EN END AS COMPNY_JC_NM
				, D.USER_AUTH_CD
				, FN_GET_COMMON_NM('USER_AUTH_CD', D.USER_AUTH_CD, '') AS USER_AUTH_NM
				, CASE WHEN #{lang} = 'kh' THEN D.USER_NM_KH ELSE D.USER_NM_EN END AS USER_NM
				, COALESCE(D.USER_TEL, COALESCE(D.USER_CELL, #{lang})) AS USER_TEL
				, D.JC_CD AS USER_JC_CD
				, CASE WHEN #{lang} = 'kh' THEN F.JC_KH ELSE F.JC_EN END AS USER_JC_NM
				, FN_GET_BASE_DATE_TIME(A.REG_DT, 'I', #{lang}) AS REG_DT
				, A.JC_AGREE_STS_CD
				, FN_GET_COMMON_NM('JC_AGREE_STS_CD', A.JC_AGREE_STS_CD, '') AS JC_AGREE_STS_NM
				, CONCAT(FN_GET_BASE_DATE_TIME(A.VIDEO_INTVW_BGN_DT, 'D', #{lang}), A.VIDEO_INTVW_BGN_HOUR, ':', A.VIDEO_INTVW_BGN_MINUTE, ' ', A.VIDEO_INTVW_BGN_AMPM, ' ~ '
				        , FN_GET_BASE_DATE_TIME(A.VIDEO_INTVW_END_DT, 'D', #{lang}), A.VIDEO_INTVW_END_HOUR, ':', A.VIDEO_INTVW_END_MINUTE, ' ', A.VIDEO_INTVW_END_AMPM) AS VIDEO_INTVW_TIME
				, A.INTVW_MNGER
				, CASE WHEN #{lang} = 'kh' THEN G.USER_NM_KH ELSE G.USER_NM_EN END AS MNGER_USER_NM
				, A.REG_DT AS ORDER_BY
				FROM CPES_VIDEO_INTVW A
				INNER JOIN CPES_VIDEO_INTVW_USER B
				ON A.VIDEO_INTVW_SEQ = B.VIDEO_INTVW_SEQ
				INNER JOIN CPES_COMPNY C
				ON A.COMPNY_SEQ = C.COMPNY_SEQ
				INNER JOIN CPES_USER D
				ON B.USER_SEQ = D.USER_SEQ
				INNER JOIN CPES_JOB_CENTER E
				ON A.JC_CD = E.JC_CD
				INNER JOIN CPES_JOB_CENTER F
				ON D.JC_CD = F.JC_CD
				LEFT JOIN CPES_USER G
				ON A.INTVW_MNGER = G.USER_SEQ
				<where>
				    <if test="compnyJcCd != null and compnyJcCd != ''">
					AND A.JC_CD				LIKE CONCAT('%', #{compnyJcCd}, '%') 
					</if>	
					<if test="userJcCd != null and userJcCd != ''">
					AND D.JC_CD				LIKE CONCAT('%', #{userJcCd}, '%') 
					</if>	
					<if test="compnyNm != null and compnyNm != '' and lang == 'kh'">
					AND C.COMPNY_NM_KH		LIKE CONCAT('%', #{compnyNm}, '%') 
					</if>
					<if test="compnyNm != null and compnyNm != '' and lang == 'en'">
					AND C.COMPNY_NM_EN		LIKE CONCAT('%', #{compnyNm}, '%') 
					</if>
					<if test="mngerTel != null and mngerTel != ''">
					AND C.MNGER_TEL			LIKE CONCAT('%', #{mngerTel}, '%') 
					</if>
					<if test="userNm != null and userNm != '' and lang == 'en'">
					AND D.USER_NM_EN		LIKE CONCAT('%', #{userNm}, '%') 
					</if>								
					<if test="userNm != null and userNm != '' and lang == 'kh'">
					AND D.USER_NM_KH		LIKE CONCAT('%', #{userNm}, '%') 
					</if>
					<if test="userTel != null and userTel != ''">
					AND C.USER_TEL			LIKE CONCAT('%', #{userTel}, '%') 
					</if>
					<if test="jcAgreeStsCd != null and jcAgreeStsCd != ''">
					AND A.JC_AGREE_STS_CD	LIKE CONCAT('%', #{jcAgreeStsCd}, '%') 
					</if>			
					<if test="startDate != null and startDate != ''">
					<![CDATA[
					AND A.REG_DT			>= FN_GET_STR_TO_DATE(#{startDate}, 'S')
					]]>
					</if>
					<if test="endDate != null and endDate != ''">
					<![CDATA[			
					AND A.REG_DT			<= FN_GET_STR_TO_DATE(#{endDate}, 'E')
					]]>
					</if>												
				</where>
		) TAB
		, (SELECT @ROWNUM := 0) Z
		<choose>
			<when test="orderColumn == 'REG_DT'">
				ORDER BY TAB.ORDER_BY ${orderColumnSort}
			</when>
        	<otherwise>
            	ORDER BY ${orderColumn} ${orderColumnSort}
            </otherwise>

        </choose>
		<if test="length > -1">
		LIMIT 
			${start} , ${length}				
		</if>
            
    </select>
      
	<select id="selectJobskVdoIntvwListTotalCnt" resultType="java.lang.Integer" parameterType="JobskVdoIntvwBean">
       	SELECT COUNT(*) AS TOTAL_COUNT
		FROM CPES_VIDEO_INTVW A
		INNER JOIN CPES_VIDEO_INTVW_USER B
		ON A.VIDEO_INTVW_SEQ = B.VIDEO_INTVW_SEQ
		INNER JOIN CPES_COMPNY C
		ON A.COMPNY_SEQ = C.COMPNY_SEQ
		INNER JOIN CPES_USER D
		ON B.USER_SEQ = D.USER_SEQ
		INNER JOIN CPES_JOB_CENTER E
		ON A.JC_CD = E.JC_CD
		INNER JOIN CPES_JOB_CENTER F
		ON D.JC_CD = F.JC_CD
		LEFT JOIN CPES_USER G
		ON A.INTVW_MNGER = G.USER_SEQ
		<where>
		    <if test="compnyJcCd != null and compnyJcCd != ''">
			AND A.JC_CD				LIKE CONCAT('%', #{compnyJcCd}, '%') 
			</if>	
			<if test="userJcCd != null and userJcCd != ''">
			AND D.JC_CD				LIKE CONCAT('%', #{userJcCd}, '%') 
			</if>	
			<if test="compnyNm != null and compnyNm != '' and lang == 'kh'">
			AND C.COMPNY_NM_KH		LIKE CONCAT('%', #{compnyNm}, '%') 
			</if>
			<if test="compnyNm != null and compnyNm != '' and lang == 'en'">
			AND C.COMPNY_NM_EN		LIKE CONCAT('%', #{compnyNm}, '%') 
			</if>
			<if test="mngerTel != null and mngerTel != ''">
			AND C.MNGER_TEL			LIKE CONCAT('%', #{mngerTel}, '%') 
			</if>
			<if test="userNm != null and userNm != '' and lang == 'en'">
			AND D.USER_NM_EN		LIKE CONCAT('%', #{userNm}, '%') 
			</if>								
			<if test="userNm != null and userNm != '' and lang == 'kh'">
			AND D.USER_NM_KH		LIKE CONCAT('%', #{userNm}, '%') 
			</if>
			<if test="userTel != null and userTel != ''">
			AND C.USER_TEL			LIKE CONCAT('%', #{userTel}, '%') 
			</if>
			<if test="jcAgreeStsCd != null and jcAgreeStsCd != ''">
			AND A.JC_AGREE_STS_CD	LIKE CONCAT('%', #{jcAgreeStsCd}, '%') 
			</if>			
			<if test="startDate != null and startDate != ''">
			<![CDATA[
			AND A.REG_DT			>= FN_GET_STR_TO_DATE(#{startDate}, 'S')
			]]>
			</if>
			<if test="endDate != null and endDate != ''">
			<![CDATA[			
			AND A.REG_DT			<= FN_GET_STR_TO_DATE(#{endDate}, 'E')
			]]>
			</if>												
		</where>		
    </select>

	<select id="selectJobskVdoIntvwDtlInfo" resultType="JobskVdoIntvwBean" parameterType="JobskVdoIntvwBean">
		SELECT
		A.VIDEO_INTVW_SEQ
		, B.VIDEO_INTVW_USER_SEQ
		, C.COMPNY_SEQ
		, D.USER_SEQ
		, CASE WHEN #{lang} = 'kh' THEN C.COMPNY_NM_KH ELSE C.COMPNY_NM_EN END COMPNY_NM
		, C.MNGER_NM
		, C.MNGER_CELL
		, C.MNGER_EMAIL
		, CASE WHEN #{lang} = 'kh' THEN D.USER_NM_KH ELSE D.USER_NM_EN END USER_NM
		, D.USER_CELL
		, CONCAT(FN_GET_BASE_DATE_TIME(A.VIDEO_INTVW_BGN_DT, 'D', #{lang}), A.VIDEO_INTVW_BGN_HOUR, ':', A.VIDEO_INTVW_BGN_MINUTE, ' ', A.VIDEO_INTVW_BGN_AMPM, ' ~ '
		        , FN_GET_BASE_DATE_TIME(A.VIDEO_INTVW_END_DT, 'D', #{lang}), A.VIDEO_INTVW_END_HOUR, ':', A.VIDEO_INTVW_END_MINUTE, ' ', A.VIDEO_INTVW_END_AMPM) AS VIDEO_INTVW_TIME
		, A.REQ_CONTENT
		, D.JC_CD AS USER_JC_CD
		, CASE WHEN #{lang} = 'kh' THEN F.JC_KH ELSE F.JC_EN END AS USER_JC_NM
		, C.JC_CD AS COMPNY_JC_CD
		, CASE WHEN #{lang} = 'kh' THEN E.JC_KH ELSE E.JC_EN END AS COMPNY_JC_NM
		, A.JC_AGREE_STS_CD
		, FN_GET_COMMON_NM('JC_AGREE_STS_CD', A.JC_AGREE_STS_CD, #{lang}) AS JC_AGREE_STS_NM
		, FN_GET_BASE_DATE_TIME(A.VIDEO_INTVW_BGN_DT, 'D', #{lang}) AS VIDEO_INTVW_BGN_DT
		, A.VIDEO_INTVW_BGN_HOUR
		, A.VIDEO_INTVW_BGN_MINUTE
		, A.VIDEO_INTVW_BGN_AMPM
		, FN_GET_BASE_DATE_TIME(A.VIDEO_INTVW_END_DT, 'D', #{lang}) AS VIDEO_INTVW_END_DT
		, A.VIDEO_INTVW_END_HOUR
		, A.VIDEO_INTVW_END_MINUTE
		, A.VIDEO_INTVW_END_AMPM
		, A.JC_AGREE_DT
		, A.INTVW_MNGER
		FROM CPES_VIDEO_INTVW A
		INNER JOIN CPES_VIDEO_INTVW_USER B
		ON A.VIDEO_INTVW_SEQ = B.VIDEO_INTVW_SEQ
		INNER JOIN CPES_COMPNY C
		ON A.COMPNY_SEQ = C.COMPNY_SEQ
		INNER JOIN CPES_USER D
		ON B.USER_SEQ = D.USER_SEQ
		LEFT JOIN CPES_JOB_CENTER E
		ON C.JC_CD = E.JC_CD
		LEFT JOIN CPES_JOB_CENTER F
		ON D.JC_CD = E.JC_CD
		WHERE A.VIDEO_INTVW_SEQ		= #{videoIntvwSeq}
    </select>
                                         
</mapper>
