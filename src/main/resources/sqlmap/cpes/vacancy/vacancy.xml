<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="vacancy">

	<select id="selectVacancyDtlInfo" resultType="VacancyBean" parameterType="VacancyBean">
		SELECT 
		A.VACANCY_SEQ
		, A.VACANCY_TITLE
		, A.EMPLOY_FORM_CD
		, FN_GET_COMMON_NM('EMPLOY_FORM_CD', A.EMPLOY_FORM_CD, '') AS EMPLOY_FORM_NM
		, A.SPOT
		, A.ISCO_CD
		, CASE WHEN #{lang} = 'kh' THEN B.KH_NM ELSE B.EN_NM END ISCO_NM
		, A.RECRUMT_MEMB
		, FN_GET_BASE_DATE_CHAR(A.BGN_DT, #{lang}) AS BGN_DT
		, FN_GET_BASE_DATE_CHAR(A.VACANCY_CLOSE_DT, #{lang}) AS VACANCY_CLOSE_DT
		, A.RECRUMT_DIFFCLT_YN
		, A.EMPLOY_CTRCT_CD
		, CONCAT(FN_GET_COMMON_NM('EMPLOY_CTRCT_CD', A.EMPLOY_CTRCT_CD, #{lang}), ' / ', A.EMPLOY_CTRCT_DURA) AS EMPLOY_CTRCT_COND
		, FN_GET_COMMON_NM('EMPLOY_CTRCT_TYPE_CD', A.EMPLOY_CTRCT_TYPE_CD, #{lang}) AS EMPLOY_CTRCT_TYPE_NM 
		, A.PREFER_EMPLOYMT_TYPE_CD
		, FN_GET_COMMON_NM('PREFER_EMPLOYMT_TYPE_CD', A.PREFER_EMPLOYMT_TYPE_CD, #{lang}) AS PREFER_EMPLOYMT_TYPE_NM
		, CONCAT(FN_GET_BASE_DATE_CHAR(A.WORK_AFTERNN_BGN_TIME, #{lang}), ' ~ ', FN_GET_BASE_DATE_CHAR(A.WORK_AFTERNN_END_TIME, #{lang})) AS WORK_AFTERNN_TIME
		, CONCAT(FN_GET_BASE_DATE_CHAR(A.WORK_MORN_BGN_TIME, #{lang}), ' ~ ', FN_GET_BASE_DATE_CHAR(A.WORK_MORN_END_TIME, #{lang})) AS WORK_MORN_TIME
		, A.DAY_WORK_TIME
		, A.WEEK_WORK_DAY
		, A.NIGHT_WORK_YN
		, A.HLDAY_WORK_YN
		, A.FLEX_WORK_YN
		, A.OVER_WORK_YN
		, CONCAT(A.PROBT_YN, ', ', A.PROBT_DURA) AS PROBT_DESC
		, CONCAT(A.TRNNG_YN, ', ', A.TRNNG_DURA) AS TRNNG_DESC
		, A.SALARY_UNIT_CD
		, CONCAT(FN_GET_COMMON_NM('SALARY_UNIT_CD', A.SALARY_UNIT_CD, #{lang}), ' ', A.MIN_SALARY_AMT, '$ ~ ', A.MAX_SALARY_AMT,  '$') AS SALARY_DESC
		, A.NSSF_YN
		, A.ETC_INSU_YN
		, A.MIN_EDU_DEGREE_YN
		, A.MIN_EDU_DEGREE_CD
		, FN_GET_COMMON_NM('MIN_EDU_DEGREE_CD', A.MIN_EDU_DEGREE_CD, #{lang}) AS MIN_EDU_DEGREE_NM
		, A.ISCED_CD
		, CASE WHEN #{lang} = 'kh' THEN C.KH_NM ELSE C.EN_NM END AS ISCED_NM
		, A.PRO_LICNS_YN
		, A.MIN_WORK_EXP_YN
		, A.MIN_WORK_EXP
		, A.ISIC_CD
		, CASE WHEN #{lang} = 'kh' THEN D.KH_NM ELSE D.EN_NM END AS ISIC_NM
		, A.JOB_DESC
		, A.RECRUMT_JOB_REF_KNOW
		, A.RECRUMT_JOB_REF_BASIC_SKILL
		, A.RECRUMT_JOB_REF_WORK_NEED_ITEM
		, A.ETC
		, A.WORK_EXPLN
		, A.MNGER_NM
		, A.MNGER_EMAIL
		, A. MNGER_CELL
		, FN_GET_BASE_DATE_TIME(A.REG_DT, 'M', #{lang}) AS APPLIC_DT
		, A.JC_AGREE_STS_CD
		, FN_GET_COMMON_NM('JC_AGREE_STS_CD', A.JC_AGREE_STS_CD, '') AS JC_AGREE_STS_NM
		, FN_GET_BASE_DATE_TIME(A.JC_AGREE_DT, 'I', #{lang}) AS JC_AGREE_DT
		, A.VACANCY_STS_CD
		, FN_GET_COMMON_NM('VACANCY_STS_CD', A.VACANCY_STS_CD, '') AS VACANCY_STS_NM
		, A.JC_USER_SEQ
		, CASE WHEN #{lang} = 'kh' THEN E.USER_NM_KH ELSE E.USER_NM_EN END AS JC_USER_NM
		, A.AGREE_REJECT_REASON
		FROM CPES_VACANCY A
		LEFT JOIN CPES_ISCO_CD B
		ON A.ISCO_CD 					= B.ISCO_CD
		LEFT JOIN CPES_ISCED_CD C
		ON A.ISCED_CD 					= C.ISCED_CD
		LEFT JOIN CPES_ISIC_CD D
		ON A.ISIC_CD 					= D.ISIC_CD
		LEFT JOIN CPES_USER E
		ON A.JC_USER_SEQ				= E.USER_SEQ 				
		WHERE A.VACANCY_SEQ				= #{vacancySeq}
		  AND A.USE_YN					= 'Y'
		  AND A.DEL_YN					!= 'Y'
            
    </select>
      
	<select id="selectVacancyDtlInfoLoc" resultType="VacancyLocBean" parameterType="VacancyLocBean">
		SELECT
		ADDR_FULL_NM
		FROM CPES_VACANCY_LOC
		WHERE VACANCY_SEQ					= #{vacancySeq}
	</select>

	<select id="selectVacancyDtlInfoLang" resultType="VacancyLangBean" parameterType="VacancyLangBean">
		SELECT
		LANG_CD
		, FN_GET_COMMON_NM('LANG_CD', LANG_CD, #{lang}) AS LANG_NM
		, LANG_LVL_CD
		, FN_GET_COMMON_NM('LANG_LVL_CD', LANG_LVL_CD, #{lang}) AS LANG_LVL_NM
		FROM CPES_VACANCY_LANG
		WHERE VACANCY_SEQ					= #{vacancySeq}
	</select>

	<select id="selectVacancyDtlInfoPrefernt" resultType="VacancyPreferntBean" parameterType="VacancyPreferntBean">
		SELECT
		PREFERNT_COND_CD
		, FN_GET_COMMON_NM('PREFERNT_COND_CD', PREFERNT_COND_CD, #{lang}) AS PREFERNT_COND_NM
		FROM CPES_VACANCY_PREFERNT_COND
		WHERE VACANCY_SEQ					= #{vacancySeq}
	</select>
	                                  
</mapper>
